#include <stdio.h>
#include <stdlib.h>
#include <sqlite3.h> 

int callback(void *NotUsed, int argc, char **argv, char **azColName) 
{
   int i;
   for(i = 0; i<argc; i++) 
   {
      printf(">> %s = %s\n", azColName[i], argv[i] ? argv[i] : "NULL");
   }
   printf("\n");
   return 0;
}

void create_table(sqlite3 *db)
{
    char *errMsg = 0;
    const char *sqlCreateTable = 
        "CREATE TABLE user ("  \
        "id INTEGER," \
        "username TEXT," \
        "password TEXT," \
        "PRIMARY KEY(id));";
    
    if (sqlite3_exec(db, sqlCreateTable, callback, 0, &errMsg) != SQLITE_OK)
    {
        fprintf(stderr, "SQL error: %s\n", errMsg);
        sqlite3_free(errMsg);
    } 
    else 
    {
        fprintf(stdout, "Table created successfully\n");
    }
}

void insert_users(sqlite3 *db)
{
    char *errMsg = 0;
    const char *sqlInsertData = 
        "INSERT INTO user (id, username, password) VALUES (1, 'homer', '2aaab795b3836904f82efc6ca2285d927aed75206214e1da383418eb90c9052f');" \
        "INSERT INTO user (id, username, password) VALUES (2, 'marge', 'b4b811fa40505329ae871e52f03527c3720c9af7fb8607819658535c5484c41e');" \
        "INSERT INTO user (id, username, password) VALUES (3, 'bart', '9551dadbf76a27457946e70d1aebebe2132f8d3bce6378d216c11853524dd3a6');" \
        "INSERT INTO user (id, username, password) VALUES (4, 'lisa', 'd84fe7e07bedb227cffff10009151d96fc944f6a1bd37cff60e8e4626a1eb1c3');" \
        "INSERT INTO user (id, username, password) VALUES (5, 'maggie', 'aae5be5f6474904b686f639e0fcfd2be440121cd889fa381a94b71750758345e');";

    if (sqlite3_exec(db, sqlInsertData, callback, 0, &errMsg) != SQLITE_OK)
    {
        fprintf(stderr, "SQL error: %s\n", errMsg);
        sqlite3_free(errMsg);
    } 
    else 
    {
        fprintf(stdout, "Data inserted successfully\n");
    }
}

int main(int argc, char* argv[])
{
    sqlite3 *db;
    int rc;

    rc = sqlite3_open("test.db", &db);
    if (rc)
    {
        fprintf(stderr, "Can't open database: %s\n", sqlite3_errmsg(db));
        return(0);
    } 
    else 
    {
        fprintf(stdout, "Opened database successfully\n");
    }

   create_table(db);
   insert_users(db);

   sqlite3_close(db);
   return 0;
}